<script>
//Select
//selectObj 와, b라는 변수에 의존적임. selectObj는, drag효과를 낼 HTML DIV 태그.
//b는, drag가 될 영역. selectObj는, b라는 태그 안에 있어야함.
//또, selectObj어ㅏ, b는 CSS layout에 의존적임.
class Select
{
	constructor(){
		//bind
		this.selectStart = this.selectStart.bind(this);
		this.selectMove = this.selectMove.bind(this);
		this.selectEnd = this.selectEnd.bind(this);

		this.x, this.y;
		this.x2, this.y2;
		this.condition;
		this.selectObj = document.getElementById("selectDiv")
		this.b = document.getElementById("writingBoard");
	}


	selectStart(event){
		this.x = event.clientX;
		this.y = event.clientY - 48; // event.offsetY을 이용하면 Editor에 Object들이 추가되었을 때. 해당 Object들의 offset까지 계산해서, 문제가 있음. 일단은 clientY- headeroffset으로 박아놓음. 추후 수정 필요.
		this.condition = true;
	}


	selectMove(event){
		if (this.condition){
		this.selectObj.style = null;
		this.selectObj.style.display = "inline-block";
		this.selectObj.style.border = "2px solid #0047AB";
		this.x2 = event.clientX;
		this.y2 = event.clientY - 48; //위와 같은 문제.
		var dx = this.x2-this.x;
		var dy = this.y2-this.y;
		if(dx<0){
			this.selectObj.style.left = this.x2;
			this.selectObj.style.width = -dx;
		}else{
			this.selectObj.style.left = this.x;
			this.selectObj.style.width = dx;
		}
		if(dy<0){
			this.selectObj.style.top = this.y2;
			this.selectObj.style.height = -dy;
		}else{
			this.selectObj.style.top = this.y;
			this.selectObj.style.height = dy;
		}
		}
	}


	selectEnd(event){
		this.condition = false;
		this.selectObj.style.display = "none";
		this.selectObj.style = null;
	}


	run(){
	this.b.addEventListener("mousedown", this.selectStart);
	this.b.addEventListener("mousemove", this.selectMove);
	this.b.addEventListener("mouseup", this.selectEnd);
	//b.addEventListener("mouseout", selectEnd);
	}
}

Selection = new Select()
Selection.run();

</script>



<script>
	//editor Object. use a class.
	/*
	props = {
		width:100px;
		height:100px;
		type:"editorObj";
	}
	*/



class editorObj
{
	constructor(props){
		//bind
		this.setProps = this.setProps.bind(this);
		this.setProps = this.setState.bind(this);
		this.createElement = this.createElement.bind(this);

		this.props = props;
		this.state = {};
		if (props == null){
			this.props = {};
		}
	}


	setProps(props){
		this.props = Object.assign(this.props, props);
	}


	setState(props){
		this.state = Object.assign(this.state, props);
	}
	createElement(DOMObj){
	this.setState({dragHandleNode:document.createElement("div")});
	this.setState({selectHandleNode:document.createElement("div")});
	this.setState({dataNode:document.createElement("div")});

	this.state.dragHandleNode.setAttribute("class","dragHandle disable-select")
	this.state.selectHandleNode.setAttribute("class","selectHandle disable-select")
	this.state.dataNode.setAttribute("class","dataNode")

	this.state.dragHandleNode.appendChild(this.state.selectHandleNode).appendChild(this.state.dataNode);
	DOMObj.appendChild(this.state.dragHandleNode);
	}
}


class textObj extends editorObj
{
	constructor(props){
		super(props);
		this.setState({type:"text"});
		this.prototype = editorObj;
	}
	createElement(DOMObj){
		super.createElement(DOMObj);
		this.state.dataNode.setAttribute("contenteditable","true");
		this.state.dataNode.focus();

		this.state.dataNode.addEventListener("keydown",(event)=>{
			if(event.keyCode == 13){
			}

		});
	}
}


//sidebar
function addText(){
	textObject = new textObj();
	temp = document.getElementById("writingLapping");
	textObject.createElement(temp);
	console.log("event!")
}
document.getElementById("addText").addEventListener("click",addText);
</script>